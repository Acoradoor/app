_HiStOrY_V2_
CREATE\040DATABASE\040mailserver;
CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1'
CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1'\040;
CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1'\040CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1'\040CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1';
GRANT\040SELECT\040ON\040mailserver.*\040TO\040'mailuser'@'localhost';
FLUSH\040PRIVILEGES;
SELECT\040User,\040Host\040FROM\040mysql.user\040WHERE\040User\040=\040'mailuser';
DROP\040USER\040IF\040EXISTS\040'mailuser'@'localhost';
CREATE\040DATABASE\040IF\040NOT\040EXISTS\040mailserver;
CREATE\040USER\040'mailuser'@'localhost'\040IDENTIFIED\040BY\040'mailuser1';
GRANT\040SELECT\040ON\040mailserver.*\040TO\040'mailuser'@'localhost';
FLUSH\040PRIVILEGES;
SELECT\040User,\040Host\040FROM\040mysql.user\040WHERE\040User\040=\040'mailuser';
USE\040mailserver;
CREATE\040TABLE\040virtual_domains\040(
\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,
\040\040\040\040name\040VARCHAR(50)\040NOT\040NULL\040UNIQUE
);
CREATE\040TABLE\040virtual_domains\040(\040\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,\040\040\040\040\040name\040VARCHAR(50)\040NOT\040NULL\040UNIQUE\040);
CREATE\040TABLE\040virtual_users\040(
\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,
\040\040\040\040domain_id\040INT\040NOT\040NULL,
\040\040\040\040email\040VARCHAR(100)\040NOT\040NULL\040UNIQUE,
\040\040\040\040password\040VARCHAR(150)\040NOT\040NULL,
\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)\040ON\040DELETE\040CASCADE
);
CREATE\040TABLE\040virtual_users\040(\040\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,\040\040\040\040\040domain_id\040INT\040NOT\040NULL,\040\040\040\040\040email\040VARCHAR(100)\040NOT\040NULL\040UNIQUE,\040\040\040\040\040password\040VARCHAR(150)\040NOT\040NULL,\040\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)\040ON\040DELETE\040CASCADE\040);
CREATE\040TABLE\040virtual_aliases\040(
\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,
\040\040\040\040domain_id\040INT\040NOT\040NULL,
\040\040\040\040source\040VARCHAR(100)\040NOT\040NULL,
\040\040\040\040destination\040VARCHAR(100)\040NOT\040NULL,
\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)\040ON\040DELETE\040CASCADE
);
CREATE\040TABLE\040virtual_aliases\040(\040\040\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT\040PRIMARY\040KEY,\040\040\040\040\040domain_id\040INT\040NOT\040NULL,\040\040\040\040\040source\040VARCHAR(100)\040NOT\040NULL,\040\040\040\040\040destination\040VARCHAR(100)\040NOT\040NULL,\040\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)\040ON\040DELETE\040CASCADE\040);
INSERT\040INTO\040virtual_domains\040(name)\040VALUES\040('acoradoor.com');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)
VALUES\040(1,\040'toni@acoradoor.com',\040'$6$hwlnFh.6DFB9MEwt$4QLARQ60gg4ZdMErSgxxcmcp7XsPT8UjQjJCIoUhnNd9E5xjonkvb/hAf5p1PEgfsmW7muTe7vpgPCWQaSsWG0');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES\040(1,\040'toni@acoradoor.com',\040'$6$hwlnFh.6DFB9MEwt$4QLARQ60gg4ZdMErSgxxcmcp7XsPT8UjQjJCIoUhnNd9E5xjonkvb/hAf5p1PEgfsmW7muTe7vpgPCWQaSsWG0');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES\040(1,\040'jesus@acoradoor.com',\040'$6$U0h45vi5OJ7TAhVr$drPWmq7tEtenQYn4Ys.3YPhifX6DHorY..HCX4hVNj0YRD03SDxMsEXTE8No05Qkp18Z4NGUQ9T8Hcf7Mh3I./');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES\040(1,\040'hector@acoradoor.com',\040'$6$Nnjp0bn5tCpmZs2H$Er8rEJBrFUiNH77KxPkKXzpElIyqHxZ6TXCMwFIGeRgM4xsYZ/C6gjaoASaWrElYdsj7.k7OlGAcWttJrB7lN1');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES\040(1,\040'administracion@acoradoor.com',\040'$6$M7FrAZZWMmHX73Cv$hYTYCuzua0lpCZOXF83tRBO5AyMvSAWfxzdx37O/pcTd0Ta6wQ.26AKe05eNkwUfqaANyWzhs4JHFeiHiseJL1');
EXIT;
UPDATE\040virtual_users\040SET\040password='{SHA512-CRYPT}AQUI_PEGA_TU_HASH_COMPLETO'\040WHERE\040email='toni@acoradoor.com';
FLUSH\040PRIVILEGES;
UPDATE\040virtual_users\040SET\040password='$6$UkrBPhOHBAIjGqOi$Ph9aiSMud3tOea5rFRovajBDtquE6Gsax0hSOfvEAzr4ieKHv7yWWFKwSMRjHKpY6bsDgSTU3ufW54LhNYqsZ0'\040WHERE\040email='toni@acoradoor.com';
FLUSH\040PRIVILEGES;
EXIT;
UPDATE\040virtual_users\040
SET\040password='{SHA512-CRYPT}$6$UkrBPhOHBAIjGqOi$Ph9aiSMud3tOea5rFRovajBDtquE6Gsax0hSOfvEAzr4ieKHv7yWWFKwSMRjHKpY6bsDgSTU3ufW54LhNYqsZ0'\040
WHERE\040email='toni@acoradoor.com';
UPDATE\040virtual_users\040\040SET\040password='{SHA512-CRYPT}$6$UkrBPhOHBAIjGqOi$Ph9aiSMud3tOea5rFRovajBDtquE6Gsax0hSOfvEAzr4ieKHv7yWWFKwSMRjHKpY6bsDgSTU3ufW54LhNYqsZ0'\040\040WHERE\040email='toni@acoradoor.com';
FLUSH\040PRIVILEGES;
EXIT;
UPDATE\040virtual_users\040\040SET\040password='{SHA512-CRYPT}$6$rObs328PWCBQOR0b$b5m1q2AhA1pMxzoXZSl0wUrogq6KvXaBzcz1HfN8W7v4JExgD.SFEr.o.sjNuxKYALDnTHhVPrEOk4/u6bi1C/'\040WHERE\040email='toni@acoradoor.com';
FLUSH\040PRIVILEGES;
EXIT;
SELECT\040email,\040password,\040LENGTH(password)\040as\040length\040FROM\040virtual_users\040WHERE\040email\040LIKE\040'%toni%';
SELECT\040
\040\040email,
\040\040CASE\040
\040\040\040\040WHEN\040password\040LIKE\040'{SHA512-CRYPT}%'\040THEN\040'OK:\040SHA512-CRYPT'\040
\040\040\040\040ELSE\040'ERROR:\040Formato\040incorrecto'\040
\040\040END\040as\040hash_check
FROM\040virtual_users\040WHERE\040email\040LIKE\040'%toni%';
SELECT\040\040\040\040email,\040\040\040CASE\040\040\040\040\040\040WHEN\040password\040LIKE\040'{SHA512-CRYPT}%'\040THEN\040'OK:\040SHA512-CRYPT'\040\040\040\040\040\040ELSE\040'ERROR:\040Formato\040incorrecto'\040\040\040\040END\040as\040hash_check\040FROM\040virtual_users\040WHERE\040email\040LIKE\040'%toni%';
SELECT\040email\040as\040user,\040password\040FROM\040virtual_users\040WHERE\040email='toni@acoradoor.com';
EXIT;
UPDATE\040virtual_users\040\040SET\040password='doveadm\040auth\040test\040toni@acoradoor.com\0402>&1'\040WHERE\040email='toni@acoradoor.com';
FLUSH\040PRIVILEGES;
EXIT;
CREATE\040DATABASE\040IF\040NOT\040EXISTS\040mailserver
\040\040CHARACTER\040SET\040utf8mb4\040COLLATE\040utf8mb4_unicode_ci;
CREATE\040DATABASE\040IF\040NOT\040EXISTS\040mailserver\040\040\040CHARACTER\040SET\040utf8mb4\040COLLATE\040utf8mb4_unicode_ci;
CREATE\040USER\040IF\040NOT\040EXISTS\040'mailuser'@'127.0.0.1'\040IDENTIFIED\040BY\040'mailuser1';
CREATE\040USER\040IF\040NOT\040EXISTS\040'mailuser'@'localhost'\040\040IDENTIFIED\040BY\040'mailuser1';
GRANT\040SELECT\040ON\040mailserver.*\040TO\040'mailuser'@'127.0.0.1';
GRANT\040SELECT\040ON\040mailserver.*\040TO\040'mailuser'@'localhost';
FLUSH\040PRIVILEGES;
USE\040mailserver;
CREATE\040TABLE\040IF\040NOT\040EXISTS\040virtual_domains\040(
\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT,
\040\040name\040VARCHAR(50)\040NOT\040NULL,
\040\040PRIMARY\040KEY\040(id),
\040\040UNIQUE\040KEY\040name\040(name)
)\040ENGINE=InnoDB\040DEFAULT\040CHARSET=utf8mb4;
CREATE\040TABLE\040IF\040NOT\040EXISTS\040virtual_domains\040(\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT,\040\040\040name\040VARCHAR(50)\040NOT\040NULL,\040\040\040PRIMARY\040KEY\040(id),\040\040\040UNIQUE\040KEY\040name\040(name)\040)\040ENGINE=InnoDB\040DEFAULT\040CHARSET=utf8mb4;
CREATE\040TABLE\040IF\040NOT\040EXISTS\040virtual_users\040(
\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT,
\040\040domain_id\040INT\040NOT\040NULL,
\040\040email\040VARCHAR(100)\040NOT\040NULL,
\040\040password\040VARCHAR(255)\040NOT\040NULL,
\040\040PRIMARY\040KEY\040(id),
\040\040UNIQUE\040KEY\040email\040(email),
\040\040CONSTRAINT\040fk_domain_id
\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)
\040\040\040\040ON\040DELETE\040CASCADE
)\040ENGINE=InnoDB\040DEFAULT\040CHARSET=utf8mb4;
CREATE\040TABLE\040IF\040NOT\040EXISTS\040virtual_users\040(\040\040\040id\040INT\040NOT\040NULL\040AUTO_INCREMENT,\040\040\040domain_id\040INT\040NOT\040NULL,\040\040\040email\040VARCHAR(100)\040NOT\040NULL,\040\040\040password\040VARCHAR(255)\040NOT\040NULL,\040\040\040PRIMARY\040KEY\040(id),\040\040\040UNIQUE\040KEY\040email\040(email),\040\040\040CONSTRAINT\040fk_domain_id\040\040\040\040\040FOREIGN\040KEY\040(domain_id)\040REFERENCES\040virtual_domains(id)\040\040\040\040\040ON\040DELETE\040CASCADE\040)\040ENGINE=InnoDB\040DEFAULT\040CHARSET=utf8mb4;
INSERT\040IGNORE\040INTO\040virtual_domains\040(name)\040VALUES\040('acoradoor.com');
SELECT\040*\040FROM\040virtual_domains;
SET\040@domain_id\040:=\040(SELECT\040id\040FROM\040virtual_domains\040WHERE\040name='acoradoor.com');
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES
(@domain_id,\040'toni@acoradoor.com',\040\040\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$DckT2gQgXb8aZjjc$i8Bb.gacHckFWakwTVDpbbOpIp2fJzJM3J82vckCz1RDn95XOxhPbR/q8PhD.D95OwPEzKbfMwWiuE7PgYY1m.'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'jesus@acoradoor.com',\040\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$gPWmNscJ/FHKxiSB$/N4wan9SFbipwIV.BuR8mTSh71NLrDhfGf8xovJqDiVochsnAmK3EHP23EVTdoeNWBJLtZqOAJtv6xdRb/iDa1'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'hector@acoradoor.com',\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$8vc9zUwnct0avt/M$0wdWffTVAV9GWGCJn4tjgUBCHHSJzcMqwzIRqoL72Z0WD5pp4CKpeC404bxPgMKrxZH5YxnfqOHKlfbscmN8t.'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'administracion@acoradoor.com',\040'{SHA512-CRYPT}$6$ymPDrvJ.qKvbtvqX$vE24XTRuQ/JMO8MLUoAkDZqDaq2pd0a0/Vbio3iFFXY/eXjt8USV/TTWHcASwT4NXGUq7d2fW/Rot1WVroEpT1')
ON\040DUPLICATE\040KEY\040UPDATE\040password=VALUES(password);
INSERT\040INTO\040virtual_users\040(domain_id,\040email,\040password)\040VALUES\040(@domain_id,\040'toni@acoradoor.com',\040\040\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$DckT2gQgXb8aZjjc$i8Bb.gacHckFWakwTVDpbbOpIp2fJzJM3J82vckCz1RDn95XOxhPbR/q8PhD.D95OwPEzKbfMwWiuE7PgYY1m.'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'jesus@acoradoor.com',\040\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$gPWmNscJ/FHKxiSB$/N4wan9SFbipwIV.BuR8mTSh71NLrDhfGf8xovJqDiVochsnAmK3EHP23EVTdoeNWBJLtZqOAJtv6xdRb/iDa1'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'hector@acoradoor.com',\040\040\040\040\040\040\040\040\040'{SHA512-CRYPT}$6$8vc9zUwnct0avt/M$0wdWffTVAV9GWGCJn4tjgUBCHHSJzcMqwzIRqoL72Z0WD5pp4CKpeC404bxPgMKrxZH5YxnfqOHKlfbscmN8t.'),\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040\040(@domain_id,\040'administracion@acoradoor.com',\040'{SHA512-CRYPT}$6$ymPDrvJ.qKvbtvqX$vE24XTRuQ/JMO8MLUoAkDZqDaq2pd0a0/Vbio3iFFXY/eXjt8USV/TTWHcASwT4NXGUq7d2fW/Rot1WVroEpT1')\040ON\040DUPLICATE\040KEY\040UPDATE\040password=VALUES(password);
SELECT\040id,\040domain_id,\040email\040FROM\040virtual_users\040ORDER\040BY\040id;
